<!-- index.html  -->

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issobra Web 2.9.04</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .character-log-link.status-offline {
            text-decoration: underline;
            text-decoration-color: #dc3545; /* Vermelho */
            text-decoration-thickness: 2px;
            text-underline-offset: 3px;
        }
        .admin-list.scrollable {
            max-height: 200px;
            overflow-y: auto;
        }
                .boss-history-link {
            color: white;
            text-decoration: none; /* Remove o sublinhado padr√£o */
        }
        .boss-history-link:hover {
            color: #ffc107; /* Opcional: Cor amarela ao passar o mouse */
            text-decoration: underline;
        }
            .boss-history-link,
    .checker-history-link { /* Adicione a nova classe aqui */
        color: white;
        text-decoration: none;
    }
    .boss-history-link:hover,
    .checker-history-link:hover { /* Adicione a nova classe aqui */
        color: #ffc107;
        text-decoration: underline;
    }
    .boss-list-item.found-today {
    background-color: #dc354533; /* Vermelho com transpar√™ncia */
    border-left: 3px solid #dc3545;
}
    .boss-history-link,
    .checker-history-link,
    .finder-history-link { /* Adicione a nova classe aqui */
        color: white;
        text-decoration: none;
    }
    .boss-history-link:hover,
    .checker-history-link:hover,
    .finder-history-link:hover { /* Adicione a nova classe aqui */
        color: #ffc107;
        text-decoration: underline;
    }
            /* Estilos comuns para ambos os bot√µes para garantir tamanho igual */
        .check-btn,
        .found-btn {
            color: white;
            border: none;
            padding: 8px 12px; /* Garante altura e largura consistentes */
            border-radius: 5px;
            margin-left: 5px;  /* Adiciona um pequeno espa√ßo entre eles */
            cursor: pointer;   /* Muda o cursor para indicar que √© clic√°vel */
            font-size: 0.9em;  /* Ajusta o tamanho da fonte */
            line-height: 1;    /* Garante alinhamento vertical do texto */
        }

        /* Cor espec√≠fica para o bot√£o de Check */
        .check-btn {
            background-color: #0d6efd; /* Azul */
        }
        .check-btn:hover {
            background-color: #0b5ed7; /* Azul mais escuro */
        }

        /* Cor espec√≠fica para o bot√£o Encontrado */
        .found-btn {
            background-color: #198754; /* Verde */
        }
        .found-btn:hover {
            background-color: #157347; /* Verde mais escuro */
        }
        .details-link {
    color: #aaa; /* Cor cinza claro */
    font-size: 0.8em;
    margin-left: 8px;
    text-decoration: none; /* Remove o sublinhado */
}
.details-link:hover {
    color: #ffc107; /* Cor amarela ao passar o mouse */
    text-decoration: underline;
}
.predicted-date {
    font-size: 0.9em;
    color: #ffc107; /* Cor amarela para destaque */
    margin: 2px 0 0 0; /* Remove margem excessiva */
}
/* Cor verde para toda a linha de log de level up de aliado */
    .log-entry.broadcast.levelup-ally {
        color: #28a745; /* Verde sucesso */
        border-left: 3px solid #28a745; /* Adiciona uma borda esquerda verde */
        background-color: rgba(40, 167, 69, 0.1); /* Fundo verde bem claro */
    }

    /* Opcional: Cor vermelha/amarela para level up de inimigos/hunteds */
    .log-entry.broadcast.levelup-other {
        color: #dc3545; /* Vermelho perigo */
        border-left: 3px solid #dc3545;
        background-color: rgba(220, 53, 69, 0.1);
        /* ou use #ffc107 para amarelo */
    }
#page-loader-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* Cor de fundo semi-transparente */
    background-color: rgba(22, 22, 25, 0.85); 
    z-index: 9998; /* Alto, mas abaixo de modais (se houver) */
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
    transition: opacity 0.3s ease;
    opacity: 1;
    /* Come√ßa vis√≠vel por padr√£o se a classe 'loader-hidden' n√£o estiver l√° */
}

/* Classe para esconder o loader suavemente */
#page-loader-overlay.loader-hidden {
    opacity: 0;
    pointer-events: none;
}

/* O spinner de carregamento */
.loader-spinner {
    border: 5px solid #f3f3f3;
    border-top: 5px solid #3675ff; /* Cor do spinner */
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
    </style>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öîÔ∏è</text></svg>">
</head>
<body>
    <div id="page-loader-overlay" class="loader-hidden">
    <div class="loader-spinner"></div>
</div>
<nav class="main-nav">
    <button class="nav-link active" data-page="respawns">
        <i class="fas fa-list-ul"></i> Respawns
        <button class="nav-link" data-page="friends">
            <i class="fas fa-users"></i> <span id="friends-nav-text">Friends / Enemies</span>
        </button>
        <button class="nav-link" data-page="planilhado">
            <i class="fas fa-calendar-alt"></i> Planilhado
        </button>
        <button class="nav-link" data-page="bosses">
        <i class="fas fa-skull"></i> Bosses
    </button>


        <button class="nav-link" data-page="warpanel">
    <i class="fas fa-shield-halved"></i>‚öîÔ∏è War Painel 
        </button>


        <div class="nav-dropdown-container">
            <button class="nav-link" id="tools-dropdown-btn">
                <i class="fas fa-tools"></i> Ferramentas <i class="fas fa-caret-down"></i>
            </button>
            <div class="nav-dropdown-menu" id="tools-dropdown-menu">
                <a href="#" class="nav-dropdown-item" data-page="calc_exp">Calculadora de XP</a>
                <a href="#" class="nav-dropdown-item" data-page="calc_loot">Split Loot</a>
                <a href="#" class="nav-dropdown-item" data-page="calc_valor">Conversor de Valores</a>
                <!-- <a href="#" class="nav-dropdown-item" data-page="quem_e_quem">Quem √© Quem?</a> -->
            </div>
        </div>
        <button class="nav-link" data-page="ranking">
    <i class="fas fa-trophy"></i> Ranking
</button>
        
        <div class="navbar-left" id="top-navbar">
            <span>| </span> 
            <span id="nav-user-account">Carregando...</span> 
            <span>></span>
            <span id="nav-user-char">Nenhum personagem</span> 
        </div>
        
<div class="navbar-right" style="margin-left: auto; display: flex; justify-content: flex-end;">
            <button id="change-name-btn">Trocar Personagem</button> 
            
             <span id="active-char-display">  </span> 
            <button id="toggle-chat-btn" class="nav-link">Chat</button> <button id="logout-btn" class="action-btn danger-btn">Sair</button> 
        </div>
    </nav>
    </button>
    
    <div id="hunted-alert-container"></div>
    
    <div class="container">
        <div id="main-content-panel" class="panel">
        </div>
        
        <div class="chat-section panel"> 
            <div >
                
            </div>
            <h2>Chat com o Bot</h2> 
            <div class="chat-options">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="sound-enabled-checkbox" checked>
                    <label for="sound-enabled-checkbox">üîä Som</label>
                </div>
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="alert-enabled-checkbox">
                    <label for="alert-enabled-checkbox">üîî Alerta</label>
                </div>
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="boss-alert-checkbox">
                    <label for="boss-alert-checkbox">üö® Boss</label>
                </div>


                <div class="checkbox-wrapper">
                    <input type="checkbox" id="toggle-war-module">
                    <label for="toggle-war-module">‚öîÔ∏è Up/Deaths</label>
                </div>


            </div>
            <div id="chat-log"></div> 
            <div id="quick-actions">
                <button id="accept-respawn-btn" class="action-btn">‚úÖ Aceitar</button> 
                <button id="open-respawn-finder-btn" class="action-btn find-btn">üîç Resp List</button> 
                <button id="open-admin-modal-btn" class="action-btn admin-btn" style="display: none;">üëë Gerenciar</button> 
            </div>
            <form id="command-form">
                <input type="text" id="command-input" placeholder="Ou digite um comando aqui..." autocomplete="off" required> 
                   <button type="submit">Enviar</button> 
            </form>
        </div>
    </div>

<div id="boss-found-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="boss-found-title">Registrar Boss Encontrado</h2>
            <button class="modal-close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <form id="boss-found-form">
                <div id="anonymous-char-wrapper" style="display: none;">
                    <label for="anonymous-char-input">Seu Personagem:</label>
                    <input type="text" id="anonymous-char-input" class="form-control" required>
                </div>

                <label for="death-time-input">Hora da Morte (opcional):</label>
                <input type="time" id="death-time-input" class="form-control">

                <label for="tokens-input">Qt. de Tokens (opcional):</label>
                <input type="number" id="tokens-input" class="form-control" min="0">

                <label for="observation-input">Observa√ß√£o (opcional):</label>
                <textarea id="observation-input" class="form-control" rows="3"></textarea>

                <button type="submit" class="action-btn success-btn" style="margin-top: 15px;">Enviar Registro</button>
            </form>
         </div>
    </div>
</div>

    <div id="respawn-finder-modal" class="modal-overlay"> 
        <div class="modal-content"> 
            <button class="modal-close-btn">&times;</button> 
            <h1>C√≥digos de Respawn</h1> 
            <div class="filter-section"> 
                   <div class="filter-group">
                    <label for="city-filter">Filtrar por Cidade:</label> 
                    <select id="city-filter"><option value="">Todas as Cidades</option></select> 
                    <div id="city-respawns" class="respawn-list"></div> 
                   </div>
                 <div class="filter-group">
                    <label for="creature-search">Buscar por Respawn:</label> 
                    <input type="text" id="creature-search" placeholder="Digite o nome do respawn..."> 
                    <div id="search-results" class="respawn-list"></div> 
                   </div>
            </div>
            <div class="full-list-section">
                <h2>Todos os C√≥digos de Respawn</h2> 
                <div id="all-respawns" class="respawn-list"></div> 
            </div>
           </div>
    </div>

    <div id="admin-modal" class="modal-overlay"> 
        <div class="modal-content admin-modal-content"> 
            <button class="modal-close-btn">&times;</button> 

            <div class="global-pause-section">
               <h3>Painel de Gerenciamento</h3> 
               <div class="quick-actions">
                   <button id="admin-pause-all-btn" class="action-btn danger-btn">üî¥ Pausar Todos</button> 
                   <button id="admin-unpause-all-btn" class="action-btn success-btn">‚ñ∂Ô∏è Despausar Todos</button> 
               </div>
            </div>
            <hr>
           
            <div class="admin-tabs">
                   <button class="tab-btn active" data-tab="members">Membros</button> 
                   <button class="tab-btn" data-tab="groups">Grupos</button>
                   <button class="tab-btn" data-tab="respawns">Respawns</button> 
                   <button class="tab-btn" data-tab="times">Tempos</button> 
                   <button class="tab-btn" data-tab="usuarios">Todos os Usu√°rios</button>
                   <button class="tab-btn" data-tab="cooldowns">Cooldowns</button>
            </div>
            
            <div id="tab-content-members" class="tab-content active"> 
                <div class="admin-container"> 
                    <div class="admin-panel">
                        <h2>Usu√°rios Registrados</h2> 
                        <input type="text" id="admin-user-search" placeholder="Buscar usu√°rio..."> 
                        <div id="admin-user-list" class="admin-list"></div> 
                    </div>
                    <div class="admin-panel">
                           <div id="admin-selected-user-panel" style="display:none;">
                               <h2>Grupos para: <span id="selected-user-name"></span></h2> 
                               <div id="user-groups-checklist" class="admin-list"></div> 
                               <button id="save-user-groups-btn" class="action-btn success-btn">Salvar Grupos do Usu√°rio</button> 
                           </div>
                    </div>
                   </div>
            </div>

            <div id="tab-content-groups" class="tab-content">
                <div class="admin-container">
                    <div class="admin-panel">
                        <h2>Selecionar Grupo</h2>
                        <div id="admin-group-selection-list" class="admin-list"></div>
                        <hr>
                        <h2>Criar / Editar Grupos</h2>
                        <div id="admin-group-list" class="admin-list"></div> 
                        <form id="admin-group-form">
                            <h3>Novo / Editar Grupo</h3>
                            <input type="hidden" id="group-id-input"> 
                            <input type="text" id="group-name-input" placeholder="Nome do Grupo (ex: VIP)" required> 
                            <input type="number" id="group-time-input" placeholder="Tempo Extra (minutos)" required> 
                            <button type="submit">Salvar Grupo</button> 
                            <button type="button" id="clear-group-form-btn">Limpar</button> 
                            <hr style="margin: 20px 0;">
                        
                            <h3>Gerenciamento de Grupos em Massa</h3>
                            <div id="admin-batch-group-management" style="display: flex; gap: 20px;">
                                </div>
                        </div>
                        </form>
                        <div id="tab-content-members" class="tab-content active">
                    </div>
                    
                    <div class="admin-panel">
                        <div id="admin-selected-group-panel" style="display:none;">
                            <h2>Membros e Respawns de: <span id="selected-group-name-details"></span></h2>
                            <hr>
                            <h3><i class="fas fa-users"></i> Usu√°rios neste Grupo</h3>
                            <div id="admin-group-users-list" class="admin-list scrollable"></div>
                            <hr>
                            <h3><i class="fas fa-skull"></i> Respawns que Requerem este Grupo</h3>
                            <div id="admin-group-respawns-list" class="admin-list scrollable"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-content-respawns" class="tab-content">
                <div class="admin-container">
                    <div class="admin-panel">
                           <h2>Todos os Respawns</h2>
                           <input type="text" id="admin-respawn-search" placeholder="Buscar por nome ou c√≥digo...">
                         <div id="admin-respawn-list" class="admin-list"></div>
                        <hr>
                        <form id="admin-respawn-form">
                            <h3>Criar / Editar Respawn</h3>
                            <input type="text" id="respawn-code-input" placeholder="C√≥digo (ex: GSLOWER)" required>
                            <input type="text" id="respawn-name-input" placeholder="Nome do Respawn (ex: Gazer Spectres)" required>
                            <input type="text" id="respawn-region-input" placeholder="Cidade / Regi√£o (ex: Feyrist)" required>
                            <div class="form-actions">
                                   <button type="submit">Salvar Respawn</button>
                                 <button type="button" id="clear-respawn-form-btn">Limpar</button>
                            </div>
                        </form>
                    </div>
                    <div class="admin-panel">
                        <div id="admin-selected-respawn-panel" style="display:none;">
                            <h2>Op√ß√µes para: <span id="selected-respawn-name"></span></h2>
                            <div class="group-checklist-item" style="background-color: transparent; padding: 10px 0;">
                                <input type="checkbox" id="respawn-planilhado-chk">
                                <label for="respawn-planilhado-chk">Dispon√≠vel no Planilhado Normal</label>
                            </div>
                            <div class="group-checklist-item" style="background-color: transparent; padding: 10px 0;">
                                <input type="checkbox" id="respawn-planilhado-double-chk">
                                <label for="respawn-planilhado-double-chk">Dispon√≠vel no Planilhado Next</label>
                            </div>
                            <hr>
                            <h4>Grupos de Acesso</h4>
                            <p>Selecione os grupos necess√°rios para reservar este respawn. Se nenhum for selecionado, o respawn √© p√∫blico.</p>
                            <div id="respawn-groups-checklist" class="admin-list"></div>
                            <hr>
                            <h4>Ranks com Restri√ß√£o de Reserva</h4>
                            <p>Selecione os ranks que <strong>N√ÉO PODER√ÉO</strong> reservar este respawn.</p>
                            <div id="respawn-ranks-checklist" class="admin-list"></div>
                            <button id="save-respawn-options-btn" class="action-btn success-btn">Salvar Op√ß√µes do Respawn</button>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="tab-content-times" class="tab-content"> 
                <div class="admin-container solo-panel"> 
                    <div class="admin-panel">
                           <h2>Tempos de Reserva por Rank (em minutos)</h2>
                         <form id="admin-add-rank-form" class="inline-form">
                               <input type="text" id="new-rank-name-input" placeholder="Nome do Novo Rank" required>
                            <input type="number" id="new-rank-time-input" placeholder="Tempo (min)" value="150" min="0" required>
                            <button type="button" id="add-rank-btn">Adicionar Rank</button>
                        </form>
                           <hr>
                        <input type="text" id="admin-times-search" placeholder="Buscar por rank...">
                        <p>Defina o tempo m√°ximo de reserva para cada rank da guilda. Ranks novos s√£o adicionados aqui automaticamente com tempo padr√£o de 150 minutos.</p>
                        <div id="admin-times-list" class="admin-list"></div>
                        <br>
                        <button id="save-times-btn" class="action-btn success-btn">Salvar Todos os Tempos</button> 
                   </div>
                </div>
            </div>

<div id="tab-content-usuarios" class="tab-content">
    <div class="admin-container solo-panel">
        <div class="admin-panel">
            <h2>Todos os Usu√°rios e Personagens Registrados</h2>
            
<div style="display: flex; gap: 10px; margin-bottom: 15px;">
    <input type="text" id="admin-all-users-search" placeholder="Buscar por nome, e-mail ou personagem..." style="flex: 2;">
    
    <select id="admin-all-users-rank-filter" class="form-control" style="flex: 1; padding: 8px; background-color: #2a2a2e; color: #f0f0f0; border: 1px solid #555; border-radius: 4px;">
        <option value="" style="background-color: #2a2a2e;">Todos os Ranks</option>
    </select>
</div>

            <div id="admin-all-users-list" class="admin-list"></div>
        </div>
    </div>
</div>



            <div id="tab-content-cooldowns" class="tab-content">
                <div class="admin-container solo-panel">
                    <div class="admin-panel">
                           <h2>Usu√°rios em Cooldown</h2>
                         <div id="admin-cooldowns-list" class="admin-list"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="log-modal" class="modal-overlay"> 
        <div class="modal-content log-modal-content"> 
            <button class="modal-close-btn">&times;</button> 
            <h1 id="log-modal-title">Log de Atividades</h1> 
            <div id="log-modal-body" class="log-modal-body"></div> 
        </div>
    </div>

    <div id="edit-user-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Editar Usu√°rio</h2>
            <button class="modal-close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <form id="edit-user-form">
                <input type="hidden" id="edit-original-email">
                
                <label for="edit-user-name">Nome Completo:</label>
                <input type="text" id="edit-user-name" class="form-control" required>
                
                <label for="edit-user-email">E-mail (Login):</label>
                <input type="email" id="edit-user-email" class="form-control" required>
                
                <label for="edit-user-phone">Telefone:</label>
                <input type="text" id="edit-user-phone" class="form-control">
                
                <div style="margin-top: 15px; text-align: right;">
                    <button type="submit" class="action-btn success-btn">Salvar Altera√ß√µes</button>
                </div>
            </form>
        </div>
    </div>
</div>
    <div id="time-breakdown-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <h1 id="time-breakdown-title">Detalhes do Tempo</h1>
            <div id="time-breakdown-body"></div>
        </div>
    </div>

    <div id="user-details-modal" class="modal-overlay">
    <div class="modal-content">
        <button class="modal-close-btn">&times;</button>
        <h1 id="details-modal-title">Detalhes do Usu√°rio</h1>
        <div id="details-modal-body">
            </div>
    </div>
</div>

<div id="boss-history-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="boss-history-title">Hist√≥rico de Checks</h2>
            <button class="modal-close-btn">&times;</button>
        </div>
        <div id="boss-history-body" class="modal-body">
            </div>
    </div>
</div>

<div id="planilhado-group-modal" class="modal-overlay">
    <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <h2 id="planilhado-group-title">Membros do Grupo Planilhado</h2>
        <div id="planilhado-group-body">
        </div>
    </div>
</div>

<div id="boss-history-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="boss-history-title">Hist√≥rico de Checks</h2>
            <button class="modal-close-btn">&times;</button>
        </div>
        <div id="boss-history-body" class="modal-body">
            </div>
    </div>
</div>
<script>
    // Este script espera que todo o conte√∫do da p√°gina HTML seja carregado antes de ser executado.
    document.addEventListener('DOMContentLoaded', () => {

        // 1. Encontra os elementos na p√°gina: o bot√£o de chat e o painel de chat.
        const toggleChatBtn = document.getElementById('toggle-chat-btn');
        const chatPanel = document.querySelector('.chat-section');

        // 2. Verifica se ambos os elementos realmente existem na p√°gina para evitar erros.
        if (toggleChatBtn && chatPanel) {
        
            // 3. Adiciona uma fun√ß√£o que ser√° executada sempre que o bot√£o for clicado.
            toggleChatBtn.addEventListener('click', () => {
                // 4. Alterna a classe 'visible' no painel de chat.
                // Se a classe n√£o existir, ela √© adicionada.
                // Se a classe j√° existir, ela √© removida.
                chatPanel.classList.toggle('visible');
            });

        } else {
            // Se um dos elementos n√£o for encontrado, exibe uma mensagem no console para depura√ß√£o.
            console.error('Bot√£o de chat ou painel de chat n√£o encontrado. Verifique os IDs no HTML.');
        }
    });
</script>
<script src="/socket.io/socket.io.js"></script> 
    <script src="client.js"></script> 
</body>
</html>